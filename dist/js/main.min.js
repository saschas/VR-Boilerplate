function createVREnabler(){var e=document.createElement("button");return e.className="switch_to_vr",e.addEventListener("click",enableVR),e.innerHTML="Enable VR",document.body.appendChild(e),e}function createVRDisabler(){var e=document.createElement("button");return e.className="switch_to_orbit hide",e.addEventListener("click",disableVR),e.innerHTML="Disable VR",document.body.appendChild(e),e}function enableFullScreenMode(e){e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen()}function disableFullScreenMode(){document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()}function enableVR(){console.log("vr enabled"),controls.orbit.enabled=!1,controls.vr.connect(),controls.type="vr",controls.enableButton.classList.add("hide"),controls.disableButton.classList.remove("hide"),enableFullScreenMode(document.documentElement)}function disableVR(){console.log("vr disabled"),controls.orbit.enabled=!0,controls.vr.disconnect(),controls.type="orbit",controls.enableButton.classList.remove("hide"),controls.disableButton.classList.add("hide"),renderer.setSize(canvas_width,canvas_height),disableFullScreenMode()}function init(){canvas_height=window.innerHeight,canvas_width=window.innerWidth,scene=new THREE.Scene,camera=new THREE.PerspectiveCamera(55,canvas_width/canvas_height,.1,1e3),camera.position.set(0,50,200),camera.lookAt(new THREE.Vector3(0,50,0)),scene.add(camera),renderer=new THREE.WebGLRenderer({alpha:!0,antialias:!0}),renderer.setPixelRatio(window.devicePixelRatio),renderer.setSize(canvas_width,canvas_height),renderer.shadowMap.enabled=!0,renderer.shadowMap.type=THREE.PCFSoftShadowMap,renderer.setClearColor(main_color,1),document.body.appendChild(renderer.domElement),controls.orbit=new THREE.OrbitControls(camera),controls.orbit.damping=.2,controls.vr=new THREE.DeviceOrientationControls(camera),effect=new THREE.StereoEffect(renderer),effect.focalLength=70,effect.eyeSeparation=2,effect.setSize(canvas_width,canvas_height),window.onresize=function(){canvas_height=window.innerHeight,canvas_width=window.innerWidth,camera.aspect=canvas_width/canvas_height,camera.updateProjectionMatrix(),renderer.setSize(canvas_width,canvas_height),effect.setSize(canvas_width,canvas_height)};var e=new THREE.SpotLight(16777215);e.position.set(0,100,100),e.intensity=1,e.castShadow=!0,scene.add(e);for(var n=new THREE.MeshLambertMaterial({color:16777215}),t=new THREE.BoxGeometry(5,5,5),r=0;50>r;r++){var a=new THREE.Mesh(t,n);a.position.x=500*(Math.random()-.5),a.position.y=500*(Math.random()-.5),a.position.z=500*(Math.random()-.5),a.updateMatrix(),a.matrixAutoUpdate=!1,scene.add(a)}}function animation(){}var main_color=16777215,canvas_height,canvas_width,renderer,scene,controls,camera,effect,controls={type:"orbit",orbit:null,vr:null,effect:null,enableButton:createVREnabler(),disableButton:createVRDisabler()},render=function(){requestAnimationFrame(render),animation(),"vr"!=controls.type?(controls.orbit.update(),renderer.render(scene,camera)):(controls.vr.update(),effect.render(scene,camera))};init(),render();